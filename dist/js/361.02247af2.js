"use strict";(self["webpackChunkmy_sideproject"]=self["webpackChunkmy_sideproject"]||[]).push([[361],{4213:function(l,e,t){t.r(e),t.d(e,{default:function(){return H}});t(7658);var o=t(3396),a=t(9242),n=t(1362),c=t(36),s=t(4870),r=t(1294);const u={class:"container-fluid row"},i={class:"col-md-3"},d={class:"col-12 col-md-9"},p=(0,o._)("label",{class:"form-label"},"id",-1),f=["value"],m=(0,o._)("label",{class:"form-label"},"名稱",-1),v=(0,o._)("label",{class:"form-label"},"價格",-1),_=(0,o._)("label",{class:"form-label"},"種類",-1),b=(0,o._)("label",{class:"form-label"},"詳情",-1),y=(0,o._)("label",{class:"form-label"},"上傳圖片",-1),g=(0,o._)("input",{type:"file",class:"form-control file"},null,-1);var h={__name:"AddProduct",setup(l){const{db:e,storage:t}=(0,n.r)();let h="";const w=(0,s.iH)(""),H=(0,o.Fl)((()=>`products_img/${x.value}/${w.value}`)),k=(0,s.iH)(""),x=(0,s.iH)("001"),U=(0,s.iH)(""),V=(0,s.iH)(""),j=(0,s.iH)(""),C=(0,s.iH)(""),I=(0,s.iH)(""),J=(0,s.qj)({newId:x,name:U,price:V,category:j,description:C,imgUrl:I});async function S(){const l=[];try{const t=await(0,c.PL)((0,c.hJ)(e,"products"));t.forEach((e=>{console.log(e.data()),l.push(e.id)}))}catch(t){console.log("取不到id")}finally{0!==l.length&&(k.value=l.reduce(((l,e)=>e>l?e:l),0),x.value=(parseInt(k.value)+1).toString().padStart(k.value.length,"0"))}}function q(){w.value=h.files[0].name;const l=(0,r.iH)(t,H.value);(0,r.KV)(l,h.files[0]).then((()=>{console.log("上傳圖片成功")})).catch((()=>{console.log("上傳圖片失敗了：")})).then((()=>{P(l)}))}function P(l){const e=l;(0,r.Jt)(e).then((l=>{I.value=l,console.log("取得圖片路徑成功")})).catch((()=>{console.log("取得圖片路徑失敗")})).then((()=>{$()}))}async function $(){try{await(0,c.pl)((0,c.JU)(e,"products",x.value),J),console.log("上傳資料成功"),A(),S()}catch(l){console.log("上傳資料失敗"),I.value=""}}function A(){U.value="",V.value="",j.value="",C.value="",I.value="",h.value=""}return(0,o.bv)((()=>{h=document.querySelector(".file"),S()})),(l,e)=>{const t=(0,o.up)("NavBar");return(0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("div",i,[(0,o.Wm)(t)]),(0,o._)("div",d,[(0,o._)("form",null,[p,(0,o._)("input",{value:J.newId,type:"text",class:"form-control",disabled:""},null,8,f),m,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>J.name=l),type:"text",class:"form-control"},null,512),[[a.nr,J.name]]),v,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>J.price=l),type:"text",class:"form-control"},null,512),[[a.nr,J.price]]),_,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>J.category=l),type:"text",class:"form-control"},null,512),[[a.nr,J.category]]),b,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>J.description=l),class:"form-control text_area",style:{height:"100px"}},null,512),[[a.nr,J.description]]),y,g]),(0,o._)("div",null,[(0,o._)("button",{onClick:q,class:"btn btn-dark d-block mt-3 fw-bold"},"上傳")])])])}}};const w=h;var H=w}}]);
//# sourceMappingURL=361.02247af2.js.map