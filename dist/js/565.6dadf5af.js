(self["webpackChunkmy_sideproject"]=self["webpackChunkmy_sideproject"]||[]).push([[565],{7972:function(e,t,i){
/*!
  * Bootstrap modal.js v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(t,s){e.exports=s(i(1437),i(4130),i(7317),i(7547),i(1884),i(632),i(5160),i(9069))})(0,(function(e,t,i,s,n,l,o,a){"use strict";const r=e=>e&&"object"===typeof e&&"default"in e?e:{default:e},d=r(t),c=r(i),u=r(s),h=r(n),_=r(l),m=r(o),f="modal",g="bs.modal",p=`.${g}`,b=".data-api",v="Escape",w=`hide${p}`,y=`hidePrevented${p}`,k=`hidden${p}`,T=`show${p}`,$=`shown${p}`,P=`resize${p}`,S=`click.dismiss${p}`,D=`mousedown.dismiss${p}`,A=`keydown.dismiss${p}`,x=`click${p}${b}`,L="modal-open",C="fade",E="show",q="modal-static",B=".modal.show",H=".modal-dialog",U=".modal-body",j='[data-bs-toggle="modal"]',I={backdrop:!0,focus:!0,keyboard:!0},M={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class z extends h.default{constructor(e,t){super(e,t),this._dialog=c.default.findOne(H,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new u.default,this._addEventListeners()}static get Default(){return I}static get DefaultType(){return M}static get NAME(){return f}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||this._isTransitioning)return;const t=d.default.trigger(this._element,T,{relatedTarget:e});t.defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(L),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){if(!this._isShown||this._isTransitioning)return;const e=d.default.trigger(this._element,w);e.defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(E),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated()))}dispose(){for(const e of[window,this._dialog])d.default.off(e,p);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new _.default({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new m.default({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const i=c.default.findOne(U,this._dialog);i&&(i.scrollTop=0),e.reflow(this._element),this._element.classList.add(E);const s=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,d.default.trigger(this._element,$,{relatedTarget:t})};this._queueCallback(s,this._dialog,this._isAnimated())}_addEventListeners(){d.default.on(this._element,A,(e=>{if(e.key===v)return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()})),d.default.on(window,P,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),d.default.on(this._element,D,(e=>{d.default.one(this._element,S,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(L),this._resetAdjustments(),this._scrollBar.reset(),d.default.trigger(this._element,k)}))}_isAnimated(){return this._element.classList.contains(C)}_triggerBackdropTransition(){const e=d.default.trigger(this._element,y);if(e.defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;"hidden"===i||this._element.classList.contains(q)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(q),this._queueCallback((()=>{this._element.classList.remove(q),this._queueCallback((()=>{this._element.style.overflowY=i}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,i=this._scrollBar.getWidth(),s=i>0;if(s&&!t){const t=e.isRTL()?"paddingLeft":"paddingRight";this._element.style[t]=`${i}px`}if(!s&&t){const t=e.isRTL()?"paddingRight":"paddingLeft";this._element.style[t]=`${i}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const i=z.getOrCreateInstance(this,e);if("string"===typeof e){if("undefined"===typeof i[e])throw new TypeError(`No method named "${e}"`);i[e](t)}}))}}return d.default.on(document,x,j,(function(t){const i=e.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),d.default.one(i,T,(t=>{t.defaultPrevented||d.default.one(i,k,(()=>{e.isVisible(this)&&this.focus()}))}));const s=c.default.findOne(B);s&&z.getInstance(s).hide();const n=z.getOrCreateInstance(i);n.toggle(this)})),a.enableDismissTrigger(z),e.defineJQueryPlugin(z),z}))},7348:function(e,t,i){"use strict";i.d(t,{P:function(){return a}});i(7658);var s=i(2578),n=i(1362),l=i(36),o=i(4870);const a=(0,s.Q_)("allProducts",(()=>{const{db:e}=(0,n.r)(),t=(0,o.qj)([]);return async function(){await(0,l.cf)((0,l.hJ)(e,"products"),(e=>{t.length=0,e.forEach((e=>{t.push(e.data())}))}))}(),{allProducts:t}}))},3565:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return J}});var s=i(3396),n=i(4870),l=i(7139),o=i(2578),a=i(7348);const r=(0,o.Q_)("oneProduct",(()=>{const e=(0,n.iH)({});return{oneProduct:e}}));var d=i(1362),c=i(36),u=i(1294),h=i(7972),_=i.n(h);const m={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},f={class:"modal-dialog"},g={class:"modal-content"},p=(0,s._)("div",{class:"modal-header"},[(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),b={class:"modal-body"},v=(0,s._)("label",{class:"form-label"},"id",-1),w=["value"],y=(0,s._)("label",{class:"form-label"},"名稱",-1),k=["value"],T=(0,s._)("label",{class:"form-label"},"價格",-1),$=["value"],P=(0,s._)("label",{class:"form-label"},"種類",-1),S=["value"],D=(0,s._)("label",{class:"form-label"},"詳情",-1),A=["value"],x=(0,s._)("label",{class:"form-label"},"上傳圖片",-1),L=(0,s._)("input",{type:"file",class:"form-control file"},null,-1);var C={__name:"EditProduct",setup(e,{expose:t}){const{db:i,storage:l}=(0,d.r)(),a=r(),{oneProduct:h}=(0,o.Jk)(a);let C="",E="";const q=()=>{C.show()},B=()=>{C.hide()};t({showModal:q,hideModal:B});const H=async()=>{const e={newId:h.value.newId,name:document.querySelector(".inputName").value,price:document.querySelector(".inputPrice").value,category:document.querySelector(".inputCategory").value,description:document.querySelector(".inputDescription").value,imgUrl:h.value.imgUrl};if(E.files[0]){console.log("i have new img");const t=(0,n.iH)(""),o=(0,s.Fl)((()=>`products_img/${e.newId}`)),a=(0,u.iH)(l,`${o.value}`);function r(){const e=(0,u.iH)(l,`${o.value}/${t.value}`);(0,u.oq)(e).then((()=>{console.log("刪除原圖片 成功")})).then((()=>{d()}))}function d(){const t=E.files[0].name,i=(0,s.Fl)((()=>`products_img/${e.newId}/${t}`)),n=(0,u.iH)(l,i.value);(0,u.KV)(n,E.files[0]).then((()=>{console.log("上傳圖片成功")})).catch((()=>{console.log("上傳圖片失敗了：")})).then((()=>{_(n)}))}function _(t){const i=t;(0,u.Jt)(i).then((t=>{e.imgUrl=t,console.log(e),console.log("取得圖片路徑成功")})).catch((()=>{console.log("取得圖片路徑失敗")})).then((()=>{m()}))}function m(){(0,c.r7)((0,c.JU)(i,"products",e.newId),e)}(0,u.aF)(a).then((e=>{e.items.forEach((e=>{t.value=e.name}))})).then((()=>{r()}))}else console.log("沒有新圖片"),(0,c.r7)((0,c.JU)(i,"products",e.newId),e);await C.hide()};function U(){}return(0,s.bv)((()=>{C=new(_())(document.querySelector("#exampleModal")),E=document.querySelector(".file")})),U(),(e,t)=>((0,s.wg)(),(0,s.iD)("div",m,[(0,s._)("div",f,[(0,s._)("div",g,[p,(0,s._)("div",b,[(0,s._)("form",null,[v,(0,s._)("input",{value:(0,n.SU)(h).newId,type:"text",class:"form-control",disabled:""},null,8,w),y,(0,s._)("input",{ref:"itemName",value:(0,n.SU)(h).name,type:"text",class:"form-control inputName"},null,8,k),T,(0,s._)("input",{ref:"itemPrice",value:(0,n.SU)(h).price,type:"text",class:"form-control inputPrice"},null,8,$),P,(0,s._)("input",{ref:"itemCategory",value:(0,n.SU)(h).category,type:"text",class:"form-control inputCategory"},null,8,S),D,(0,s._)("textarea",{ref:"itemDescription",value:(0,n.SU)(h).description,class:"form-control text_area inputDescription",style:{height:"100px"}},null,8,A),x,L])]),(0,s._)("div",{class:"modal-footer"},[(0,s._)("button",{type:"button",class:"btn btn-dark d-block mt-3 fw-bold",onClick:H},"儲存更改")])])])]))}};const E=C;var q=E;const B={class:"container-fluid row"},H={class:"col-md-3"},U={class:"col-12 col-md-9"},j=(0,s._)("tr",null,[(0,s._)("th",null,"名稱"),(0,s._)("th",null,"單價"),(0,s._)("th",null,"種類"),(0,s._)("th",null,"編輯"),(0,s._)("th",null,"刪除")],-1),I=["onClick"];var M={__name:"DashBoard",setup(e){const t=(0,a.P)(),{allProducts:i}=(0,o.Jk)(t),d=r(),{oneProduct:c}=(0,o.Jk)(d),u=(0,n.iH)(null),h=e=>{c.value=e,console.log(e)};function _(){}return(0,s.bv)((()=>{})),_(),(e,t)=>{const o=(0,s.up)("NavBar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",B,[(0,s._)("div",H,[(0,s.Wm)(o)]),(0,s._)("div",U,[(0,s._)("table",null,[j,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,n.SU)(i),((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t},[(0,s._)("td",null,(0,l.zw)(e.name),1),(0,s._)("td",null,(0,l.zw)(e.price),1),(0,s._)("td",null,(0,l.zw)(e.category),1),(0,s._)("td",null,[(0,s._)("button",{class:"btn btn-dark",onClick:t=>{u.value.showModal(),h(e)}},"修改",8,I)])])))),128))])])]),(0,s.Wm)(q,{ref_key:"editProduct",ref:u},null,512)],64)}}};const z=M;var J=z}}]);
//# sourceMappingURL=565.6dadf5af.js.map